<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es">
<head>
<!-- 2016-03-06 dom 17:02 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="viewport" content="width=device-width, initial-scale=1" />
<title>Funciones</title>
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Oscar Perpiñán Lamigueiro \\ [[http://oscarperpinan.github.io]]" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Funciones</h1>
<div id="table-of-contents">
<h2>&Iacute;ndice</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline12">1. Conceptos Básicos</a>
<ul>
<li><a href="#orgheadline1">1.1. Fuentes de información</a></li>
<li><a href="#orgheadline2">1.2. Componentes de una función</a></li>
<li><a href="#orgheadline3">1.3. Mi primera función</a></li>
<li><a href="#orgheadline4">1.4. Mi primera función</a></li>
<li><a href="#orgheadline5">1.5. Argumentos: nombre y orden</a></li>
<li><a href="#orgheadline6">1.6. Argumentos: valores por defecto</a></li>
<li><a href="#orgheadline7">1.7. Funciones sin argumentos</a></li>
<li><a href="#orgheadline8">1.8. Argumentos sin nombre: <code>...</code></a></li>
<li><a href="#orgheadline9">1.9. Argumentos ausentes: <code>missing</code></a></li>
<li><a href="#orgheadline10">1.10. Control de errores: <code>stopifnot</code></a></li>
<li><a href="#orgheadline11">1.11. Control de errores: <code>stop</code></a></li>
</ul>
</li>
<li><a href="#orgheadline19">2. Lexical scope</a>
<ul>
<li><a href="#orgheadline13">2.1. Clases de variables</a></li>
<li><a href="#orgheadline14">2.2. Lexical scope</a></li>
<li><a href="#orgheadline15">2.3. Lexical scope: funciones anidadas</a></li>
<li><a href="#orgheadline16">2.4. Lexical scope: funciones anidadas</a></li>
<li><a href="#orgheadline17">2.5. Funciones que devuelven funciones</a></li>
<li><a href="#orgheadline18">2.6. Funciones que devuelven funciones</a></li>
</ul>
</li>
<li><a href="#orgheadline25">3. Debug</a>
<ul>
<li><a href="#orgheadline20">3.1. Post-mortem: <code>traceback</code></a></li>
<li><a href="#orgheadline21">3.2. Analizar antes de que ocurra: <code>debug</code></a></li>
<li><a href="#orgheadline22">3.3. Analizar antes de que ocurra: <code>trace</code></a></li>
<li><a href="#orgheadline23">3.4. Analizar antes de que ocurra: <code>trace</code></a></li>
<li><a href="#orgheadline24">3.5. Más recursos</a></li>
</ul>
</li>
<li><a href="#orgheadline29">4. Profiling</a>
<ul>
<li><a href="#orgheadline26">4.1. ¿Cuánto tarda mi función? <code>system.time</code></a></li>
<li><a href="#orgheadline27">4.2. ¿Cuánto tarda cada parte de mi función?: <code>Rprof</code></a></li>
<li><a href="#orgheadline28">4.3. ¿Cuánto tarda cada parte de mi función?: <code>Rprof</code></a></li>
</ul>
</li>
<li><a href="#orgheadline35">5. Miscelánea</a>
<ul>
<li><a href="#orgheadline30">5.1. <code>do.call</code></a></li>
<li><a href="#orgheadline31">5.2. <code>do.call</code></a></li>
<li><a href="#orgheadline32">5.3. <code>Reduce</code></a></li>
<li><a href="#orgheadline33">5.4. <code>Reduce</code></a></li>
<li><a href="#orgheadline34">5.5. Funciones recursivas</a></li>
</ul>
</li>
</ul>
</div>
</div>


<div id="outline-container-orgheadline12" class="outline-2">
<h2 id="orgheadline12"><span class="section-number-2">1</span> Conceptos Básicos</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-orgheadline1" class="outline-3">
<h3 id="orgheadline1"><span class="section-number-3">1.1</span> Fuentes de información</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li><a href="http://cran.r-project.org/doc/manuals/R-intro.html">R introduction</a></li>
<li><a href="http://cran.r-project.org/doc/manuals/R-lang.html">R Language Definition</a></li>
<li><a href="http://www.springer.com/gb/book/9780387759357">Software for Data Analysis</a></li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline2" class="outline-3">
<h3 id="orgheadline2"><span class="section-number-3">1.2</span> Componentes de una función</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>Una función se define con <code>function</code></li>
</ul>
<div class="org-center">
<p>
<code>name &lt;- function(arg_1, arg_2, ...) expression</code>
</p>
</div>
<ul class="org-ul">
<li>Está compuesta por:
<ul class="org-ul">
<li>Nombre de la función (<code>name</code>)</li>
<li>Argumentos (<code>arg_1</code>, <code>arg_2</code>, <code>...</code>)</li>
<li>Cuerpo (<code>expression</code>): emplea los argumentos para generar un resultado</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline3" class="outline-3">
<h3 id="orgheadline3"><span class="section-number-3">1.3</span> Mi primera función</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li>Definición</li>
</ul>
<div class="org-src-container">

<pre class="src src-R"><span class="org-function-name">myFun</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>(x, y)
{
    x + y
}
</pre>
</div>

<ul class="org-ul">
<li>Argumentos</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">formals(myFun)
</pre>
</div>

<pre class="example">
$x


$y
</pre>

<ul class="org-ul">
<li>Cuerpo</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">body(myFun)
</pre>
</div>

<pre class="example">
{
    x + y
}
</pre>
</div>
</div>

<div id="outline-container-orgheadline4" class="outline-3">
<h3 id="orgheadline4"><span class="section-number-3">1.4</span> Mi primera función</h3>
<div class="outline-text-3" id="text-1-4">
<div class="org-src-container">

<pre class="src src-R">myFun(1, 2)
</pre>
</div>

<pre class="example">
[1] 3
</pre>

<div class="org-src-container">

<pre class="src src-R">myFun(1:10, 21:30)
</pre>
</div>

<pre class="example">
[1] 22 24 26 28 30 32 34 36 38 40
</pre>

<div class="org-src-container">

<pre class="src src-R">myFun(1:10, 3)
</pre>
</div>

<pre class="example">
[1]  4  5  6  7  8  9 10 11 12 13
</pre>
</div>
</div>

<div id="outline-container-orgheadline5" class="outline-3">
<h3 id="orgheadline5"><span class="section-number-3">1.5</span> Argumentos: nombre y orden</h3>
<div class="outline-text-3" id="text-1-5">
<p>
Una función identifica sus argumentos por su nombre y por su orden (sin nombre)
</p>

<div class="org-src-container">

<pre class="src src-R"><span class="org-function-name">power</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>(x, exp)
{
    x^exp
}
</pre>
</div>

<div class="org-src-container">

<pre class="src src-R">power(x=1:10, exp=2)
</pre>
</div>

<pre class="example">
[1]   1   4   9  16  25  36  49  64  81 100
</pre>

<div class="org-src-container">

<pre class="src src-R">power(1:10, exp=2)
</pre>
</div>

<pre class="example">
[1]   1   4   9  16  25  36  49  64  81 100
</pre>

<div class="org-src-container">

<pre class="src src-R">power(exp=2, x=1:10)
</pre>
</div>

<pre class="example">
[1]   1   4   9  16  25  36  49  64  81 100
</pre>
</div>
</div>

<div id="outline-container-orgheadline6" class="outline-3">
<h3 id="orgheadline6"><span class="section-number-3">1.6</span> Argumentos: valores por defecto</h3>
<div class="outline-text-3" id="text-1-6">
<ul class="org-ul">
<li>Se puede asignar un valor por defecto a los argumentos</li>
</ul>
<div class="org-src-container">

<pre class="src src-R"><span class="org-function-name">power</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>(x, exp = 2)
{
    x ^ exp
}
</pre>
</div>

<div class="org-src-container">

<pre class="src src-R">power(1:10)
</pre>
</div>

<pre class="example">
[1]   1   4   9  16  25  36  49  64  81 100
</pre>

<div class="org-src-container">

<pre class="src src-R">power(1:10, 2)
</pre>
</div>

<pre class="example">
[1]   1   4   9  16  25  36  49  64  81 100
</pre>
</div>
</div>

<div id="outline-container-orgheadline7" class="outline-3">
<h3 id="orgheadline7"><span class="section-number-3">1.7</span> Funciones sin argumentos</h3>
<div class="outline-text-3" id="text-1-7">
<div class="org-src-container">

<pre class="src src-R"><span class="org-function-name">hello</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>()
{
    print(<span class="org-string">'Hello world!'</span>)
}
</pre>
</div>

<div class="org-src-container">

<pre class="src src-R">hello()
</pre>
</div>

<pre class="example">
[1] "Hello world!"
</pre>
</div>
</div>

<div id="outline-container-orgheadline8" class="outline-3">
<h3 id="orgheadline8"><span class="section-number-3">1.8</span> Argumentos sin nombre: <code>...</code></h3>
<div class="outline-text-3" id="text-1-8">
<div class="org-src-container">

<pre class="src src-R"><span class="org-function-name">pwrSum</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>(x, power, ...)
{
    sum(x ^ power, ...)
}
</pre>
</div>

<div class="org-src-container">

<pre class="src src-R">x <span class="org-constant">&lt;-</span> 1:10
pwrSum(x, 2)
</pre>
</div>

<pre class="example">
[1] 385
</pre>

<div class="org-src-container">

<pre class="src src-R">x <span class="org-constant">&lt;-</span> c(1:5, <span class="org-type">NA</span>, 6:9, <span class="org-type">NA</span>, 10)
pwrSum(x, 2)
</pre>
</div>

<pre class="example">
[1] NA
</pre>

<div class="org-src-container">

<pre class="src src-R">pwrSum(x, 2, na.rm=<span class="org-type">TRUE</span>)
</pre>
</div>

<pre class="example">
[1] 385
</pre>
</div>
</div>

<div id="outline-container-orgheadline9" class="outline-3">
<h3 id="orgheadline9"><span class="section-number-3">1.9</span> Argumentos ausentes: <code>missing</code></h3>
<div class="outline-text-3" id="text-1-9">
<div class="org-src-container">

<pre class="src src-R"><span class="org-function-name">suma10</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>(x, y)
{
    <span class="org-keyword">if</span> (missing(y)) y <span class="org-constant">&lt;-</span> 10
    x + y
}
</pre>
</div>

<div class="org-src-container">

<pre class="src src-R">suma10(1:10)
</pre>
</div>

<pre class="example">
[1] 11 12 13 14 15 16 17 18 19 20
</pre>
</div>
</div>

<div id="outline-container-orgheadline10" class="outline-3">
<h3 id="orgheadline10"><span class="section-number-3">1.10</span> Control de errores: <code>stopifnot</code></h3>
<div class="outline-text-3" id="text-1-10">
<div class="org-src-container">

<pre class="src src-R"><span class="org-function-name">foo</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>(x, y)
{
    stopifnot(is.numeric(x) &amp; is.numeric(y))
    x + y
}
</pre>
</div>

<div class="org-src-container">

<pre class="src src-R">foo(1:10, 21:30)
</pre>
</div>

<pre class="example">
[1] 22 24 26 28 30 32 34 36 38 40
</pre>

<div class="org-src-container">

<pre class="src src-R">foo(1:10, <span class="org-string">'a'</span>)
</pre>
</div>

<pre class="example">
Error: is.numeric(x) &amp; is.numeric(y) is not TRUE
</pre>
</div>
</div>

<div id="outline-container-orgheadline11" class="outline-3">
<h3 id="orgheadline11"><span class="section-number-3">1.11</span> Control de errores: <code>stop</code></h3>
<div class="outline-text-3" id="text-1-11">
<div class="org-src-container">

<pre class="src src-R"><span class="org-function-name">foo</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>(x, y){
    <span class="org-keyword">if</span> (!(is.numeric(x) &amp; is.numeric(y))){
        <span class="org-keyword">stop</span>(<span class="org-string">'arguments must be numeric.'</span>)
    } <span class="org-keyword">else</span> { x + y }
}
</pre>
</div>

<div class="org-src-container">

<pre class="src src-R">foo(2, 3)
</pre>
</div>

<pre class="example">
[1] 5
</pre>

<div class="org-src-container">

<pre class="src src-R">foo(2, <span class="org-string">'a'</span>)
</pre>
</div>

<pre class="example">
Error in foo(2, "a") (from #3) : arguments must be numeric.
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline19" class="outline-2">
<h2 id="orgheadline19"><span class="section-number-2">2</span> Lexical scope</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-orgheadline13" class="outline-3">
<h3 id="orgheadline13"><span class="section-number-3">2.1</span> Clases de variables</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>Las variables que se emplean en el cuerpo de una función pueden
dividirse en:
<ul class="org-ul">
<li>Parámetros formales (argumentos): <code>x</code>, <code>y</code></li>
<li>Variables locales (definiciones internas): <code>z</code>, <code>w</code>, <code>m</code></li>
<li>Variables libres: <code>a</code>, <code>b</code></li>
</ul></li>
</ul>
<div class="org-src-container">

<pre class="src src-R"><span class="org-function-name">myFun</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>(x, y){
    z <span class="org-constant">&lt;-</span> x^2
    w <span class="org-constant">&lt;-</span> y^3
    m <span class="org-constant">&lt;-</span> a*z + b*w
    m
}
</pre>
</div>

<div class="org-src-container">

<pre class="src src-R">a <span class="org-constant">&lt;-</span> 10
b <span class="org-constant">&lt;-</span> 20
myFun(2, 3)
</pre>
</div>

<pre class="example">
[1] 580
</pre>
</div>
</div>

<div id="outline-container-orgheadline14" class="outline-3">
<h3 id="orgheadline14"><span class="section-number-3">2.2</span> Lexical scope</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li>Las variables libres deben estar disponibles en el entorno
(<code>environment</code>) en el que la función ha sido creada.</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">environment(myFun)
</pre>
</div>

<pre class="example">
&lt;environment: R_GlobalEnv&gt;
</pre>

<div class="org-src-container">

<pre class="src src-R">ls()
</pre>
</div>

<pre class="example">
 [1] "a"          "addTask"    "b"          "createTask" "createToDo"
 [6] "foo"        "hello"      "lmFertEdu"  "myFun"      "myList"    
[11] "myListOops" "myToDo"     "power"      "print"      "pwrSum"    
[16] "suma10"     "task1"      "task2"      "valida"     "x"         
[21] "xyplot"
</pre>
</div>
</div>

<div id="outline-container-orgheadline15" class="outline-3">
<h3 id="orgheadline15"><span class="section-number-3">2.3</span> Lexical scope: funciones anidadas</h3>
<div class="outline-text-3" id="text-2-3">
<div class="org-src-container">

<pre class="src src-R"><span class="org-function-name">anidada</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>(x, y){
    xn <span class="org-constant">&lt;-</span> 2
    yn <span class="org-constant">&lt;-</span> 3
    <span class="org-function-name">interna</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>(x, y)
    {
        sum(x^xn, y^yn)
    }
    print(environment(interna))
    interna(x, y)
}
</pre>
</div>

<div class="org-src-container">

<pre class="src src-R">anidada(1:3, 2:4)
</pre>
</div>

<pre class="example">
&lt;environment: 0x2575760&gt;
[1] 113
</pre>

<div class="org-src-container">

<pre class="src src-R">sum((1:3)^2, (2:4)^3)
</pre>
</div>

<pre class="example">
[1] 113
</pre>
</div>
</div>

<div id="outline-container-orgheadline16" class="outline-3">
<h3 id="orgheadline16"><span class="section-number-3">2.4</span> Lexical scope: funciones anidadas</h3>
<div class="outline-text-3" id="text-2-4">
<div class="org-src-container">

<pre class="src src-R">xn
</pre>
</div>

<pre class="example">
Error: objeto 'xn' no encontrado
</pre>

<div class="org-src-container">

<pre class="src src-R">yn
</pre>
</div>

<pre class="example">
Error: objeto 'yn' no encontrado
</pre>

<div class="org-src-container">

<pre class="src src-R">interna
</pre>
</div>

<pre class="example">
Error: objeto 'interna' no encontrado
</pre>
</div>
</div>

<div id="outline-container-orgheadline17" class="outline-3">
<h3 id="orgheadline17"><span class="section-number-3">2.5</span> Funciones que devuelven funciones</h3>
<div class="outline-text-3" id="text-2-5">
<div class="org-src-container">

<pre class="src src-R"><span class="org-function-name">constructor</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>(m, n){
    <span class="org-keyword">function</span>(x)
    {
        m*x + n
    }
}
</pre>
</div>

<div class="org-src-container">

<pre class="src src-R">myFoo <span class="org-constant">&lt;-</span> constructor(10, 3)
myFoo
</pre>
</div>

<pre class="example">
function(x)
    {
        m*x + n
    }
&lt;environment: 0x272cef8&gt;
</pre>

<div class="org-src-container">

<pre class="src src-R"><span class="org-comment-delimiter">## </span><span class="org-comment">10*5 + 3</span>
myFoo(5)
</pre>
</div>

<pre class="example">
[1] 53
</pre>
</div>
</div>

<div id="outline-container-orgheadline18" class="outline-3">
<h3 id="orgheadline18"><span class="section-number-3">2.6</span> Funciones que devuelven funciones</h3>
<div class="outline-text-3" id="text-2-6">
<div class="org-src-container">

<pre class="src src-R">class(myFoo)
</pre>
</div>

<pre class="example">
[1] "function"
</pre>

<div class="org-src-container">

<pre class="src src-R">environment(myFoo)
</pre>
</div>

<pre class="example">
&lt;environment: 0x272cef8&gt;
</pre>

<div class="org-src-container">

<pre class="src src-R">ls()
</pre>
</div>

<pre class="example">
 [1] "a"           "addTask"     "anidada"     "b"           "constructor"
 [6] "createTask"  "createToDo"  "foo"         "hello"       "lmFertEdu"  
[11] "myFoo"       "myFun"       "myList"      "myListOops"  "myToDo"     
[16] "power"       "print"       "pwrSum"      "suma10"      "task1"      
[21] "task2"       "valida"      "x"           "xyplot"
</pre>

<div class="org-src-container">

<pre class="src src-R">ls(env = environment(myFoo))
</pre>
</div>

<pre class="example">
[1] "m" "n"
</pre>

<div class="org-src-container">

<pre class="src src-R">get(<span class="org-string">'m'</span>, env = environment(myFoo))
</pre>
</div>

<pre class="example">
[1] 10
</pre>

<div class="org-src-container">

<pre class="src src-R">get(<span class="org-string">'n'</span>, env = environment(myFoo))
</pre>
</div>

<pre class="example">
[1] 3
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline25" class="outline-2">
<h2 id="orgheadline25"><span class="section-number-2">3</span> Debug</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-orgheadline20" class="outline-3">
<h3 id="orgheadline20"><span class="section-number-3">3.1</span> Post-mortem: <code>traceback</code></h3>
<div class="outline-text-3" id="text-3-1">
<div class="org-src-container">

<pre class="src src-R"><span class="org-function-name">sumSq</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>(x, ...){
    sum(x ^ 2, ...)
}

<span class="org-function-name">sumProd</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>(x, y, ...){
    xs <span class="org-constant">&lt;-</span> sumSq(x, ...)
    ys <span class="org-constant">&lt;-</span> sumSq(y, ...)
    xs * ys
}
</pre>
</div>

<div class="org-src-container">

<pre class="src src-R">sumProd(rnorm(10), runif(10))
</pre>
</div>

<pre class="example">
[1] 15.79409
</pre>

<div class="org-src-container">

<pre class="src src-R">sumProd(rnorm(10), letters[1:10])
</pre>
</div>

<pre class="example">
Error in x^2 (from #2) : argumento no-numérico para operador binario
</pre>

<div class="org-src-container">

<pre class="src src-R">traceback()
</pre>
</div>

<pre class="example">
2: sumSq(y, ...) at #3
1: sumProd(rnorm(10), letters[1:10])
</pre>
</div>
</div>

<div id="outline-container-orgheadline21" class="outline-3">
<h3 id="orgheadline21"><span class="section-number-3">3.2</span> Analizar antes de que ocurra: <code>debug</code></h3>
<div class="outline-text-3" id="text-3-2">
<ul class="org-ul">
<li>Activa la ejecución paso a paso de una función</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">debug(sumProd)
</pre>
</div>

<ul class="org-ul">
<li>Cada vez que se llame a la función, su cuerpo se ejecuta línea a línea y los resultados de cada paso pueden ser inspeccionados.</li>
<li>Los comandos disponibles son:
<ul class="org-ul">
<li><code>n</code> o intro: avanzar un paso.</li>
<li><code>c</code>: continua hasta el final del contexto actual (por ejemplo,
terminar un bucle).</li>
<li><code>where</code>: entrega la lista de todas las llamadas activas.</li>
<li><code>Q</code>: termina la inspección y vuelve al nivel superior.</li>
</ul></li>
<li>Para desactivar el análisis:</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">undebug(sumProd)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline22" class="outline-3">
<h3 id="orgheadline22"><span class="section-number-3">3.3</span> Analizar antes de que ocurra: <code>trace</code></h3>
<div class="outline-text-3" id="text-3-3">
<ul class="org-ul">
<li><code>trace</code> permite mayor control que <code>debug</code></li>
</ul>
<div class="org-src-container">

<pre class="src src-R">trace(sumProd, tracer=browser, exit=browser)
</pre>
</div>

<pre class="example">
[1] "sumProd"
</pre>

<ul class="org-ul">
<li>La función queda modificada</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">sumProd
</pre>
</div>

<pre class="example">
Object with tracing code, class "functionWithTrace"
Original definition: 
function(x, y, ...){
    xs &lt;- sumSq(x, ...)
    ys &lt;- sumSq(y, ...)
    xs * ys
}

## (to see the tracing code, look at body(object))
</pre>

<div class="org-src-container">

<pre class="src src-R">body(sumProd)
</pre>
</div>

<pre class="example">
{
    on.exit(.doTrace(browser(), "on exit"))
    {
        .doTrace(browser(), "on entry")
        {
            xs &lt;- sumSq(x, ...)
            ys &lt;- sumSq(y, ...)
            xs * ys
        }
    }
}
</pre>
</div>
</div>

<div id="outline-container-orgheadline23" class="outline-3">
<h3 id="orgheadline23"><span class="section-number-3">3.4</span> Analizar antes de que ocurra: <code>trace</code></h3>
<div class="outline-text-3" id="text-3-4">
<ul class="org-ul">
<li>Los comandos <code>n</code> y <code>c</code> cambian respecto a <code>debug</code>:
<ul class="org-ul">
<li><code>c</code> o intro: avanzar un paso.</li>
<li><code>n</code>: continua hasta el final del contexto actual (por ejemplo,
terminar un bucle).</li>
</ul></li>
<li>Para desactivar</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">untrace(sumProd)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline24" class="outline-3">
<h3 id="orgheadline24"><span class="section-number-3">3.5</span> Más recursos</h3>
<div class="outline-text-3" id="text-3-5">
<ul class="org-ul">
<li>Debugging en RStudio
<ul class="org-ul">
<li><a href="https://support.rstudio.com/hc/en-us/articles/205612627-Debugging-with-RStudio">Artículo</a></li>
<li><a href="https://vimeo.com/97831988">Vídeo</a></li>
</ul></li>
<li><a href="http://adv-r.had.co.nz/Exceptions-Debugging.html"><i>Debugging</i> explicado por H. Wickham</a></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgheadline29" class="outline-2">
<h2 id="orgheadline29"><span class="section-number-2">4</span> Profiling</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-orgheadline26" class="outline-3">
<h3 id="orgheadline26"><span class="section-number-3">4.1</span> ¿Cuánto tarda mi función? <code>system.time</code></h3>
<div class="outline-text-3" id="text-4-1">
<div class="org-src-container">

<pre class="src src-R"><span class="org-function-name">noise</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>(sd)rnorm(1000, mean=0, sd=sd)
</pre>
</div>

<div class="org-src-container">

<pre class="src src-R"><span class="org-function-name">sumNoise</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>(nComponents){
    vals <span class="org-constant">&lt;-</span> sapply(seq_len(nComponents), noise)
    rowSums(vals)
}
</pre>
</div>

<div class="org-src-container">

<pre class="src src-R">system.time(sumNoise(1000))
</pre>
</div>

<pre class="example">
 user  system elapsed 
0.284   0.012   0.298
</pre>
</div>
</div>

<div id="outline-container-orgheadline27" class="outline-3">
<h3 id="orgheadline27"><span class="section-number-3">4.2</span> ¿Cuánto tarda cada parte de mi función?: <code>Rprof</code></h3>
<div class="outline-text-3" id="text-4-2">
<ul class="org-ul">
<li>Usaremos un fichero temporal</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">tmp <span class="org-constant">&lt;-</span> tempfile()
</pre>
</div>

<ul class="org-ul">
<li>Activamos la toma de información</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">Rprof(tmp)
</pre>
</div>

<ul class="org-ul">
<li>Ejecutamos el código a analizar</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">zz <span class="org-constant">&lt;-</span> sumNoise(1000)
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline28" class="outline-3">
<h3 id="orgheadline28"><span class="section-number-3">4.3</span> ¿Cuánto tarda cada parte de mi función?: <code>Rprof</code></h3>
<div class="outline-text-3" id="text-4-3">
<ul class="org-ul">
<li>Paramos el análisis</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">Rprof()
</pre>
</div>

<ul class="org-ul">
<li>Extraemos el resumen</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">summaryRprof(tmp)
</pre>
</div>

<pre class="example">
$by.self
        self.time self.pct total.time total.pct
"rnorm"      0.22    91.67       0.22     91.67
"array"      0.02     8.33       0.02      8.33

$by.total
                 total.time total.pct self.time self.pct
"sapply"               0.24    100.00      0.00     0.00
"sumNoise"             0.24    100.00      0.00     0.00
"rnorm"                0.22     91.67      0.22    91.67
"FUN"                  0.22     91.67      0.00     0.00
"lapply"               0.22     91.67      0.00     0.00
"array"                0.02      8.33      0.02     8.33
"simplify2array"       0.02      8.33      0.00     0.00

$sample.interval
[1] 0.02

$sampling.time
[1] 0.24
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline35" class="outline-2">
<h2 id="orgheadline35"><span class="section-number-2">5</span> Miscelánea</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-orgheadline30" class="outline-3">
<h3 id="orgheadline30"><span class="section-number-3">5.1</span> <code>do.call</code></h3>
<div class="outline-text-3" id="text-5-1">
<ul class="org-ul">
<li>Ejemplo: sumar los componentes de una lista</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">lista <span class="org-constant">&lt;-</span> list(a = rnorm(100),
              b = runif(100),
              c = rexp(100))
with(lista, sum(a + b + c))
</pre>
</div>

<pre class="example">
[1] 146.3971
</pre>

<ul class="org-ul">
<li>En lugar de nombrar los componentes, creamos una llamada a una
función con <code>do.call</code></li>
</ul>
<div class="org-src-container">

<pre class="src src-R">do.call(sum, lista)
</pre>
</div>

<pre class="example">
[1] 146.3971
</pre>
</div>
</div>

<div id="outline-container-orgheadline31" class="outline-3">
<h3 id="orgheadline31"><span class="section-number-3">5.2</span> <code>do.call</code></h3>
<div class="outline-text-3" id="text-5-2">
<ul class="org-ul">
<li>Se emplea frecuentemente con el resultado de <code>lapply</code></li>
</ul>
<div class="org-src-container">

<pre class="src src-R">  x <span class="org-constant">&lt;-</span> rnorm(5)
  ll <span class="org-constant">&lt;-</span> lapply(1:5, <span class="org-keyword">function</span>(i)x^i)
  do.call(rbind, ll)
</pre>
</div>

<pre class="example">
            [,1]      [,2]         [,3]     [,4]      [,5]
[1,] -0.50831978 -1.286748 -0.396631080 1.321257 -1.320122
[2,]  0.25838900  1.655719  0.157316213 1.745721  1.742722
[3,] -0.13134424 -2.130493 -0.062396500 2.306546 -2.300605
[4,]  0.06676487  2.741407  0.024748391 3.047541  3.037079
[5,] -0.03393791 -3.527498 -0.009815981 4.026586 -4.009314
</pre>

<ul class="org-ul">
<li>Este mismo ejemplo puede resolverse con <code>sapply</code></li>
</ul>
<div class="org-src-container">

<pre class="src src-R">  sapply(1:5, <span class="org-keyword">function</span>(i)x^i)
</pre>
</div>

<pre class="example">
           [,1]      [,2]       [,3]       [,4]         [,5]
[1,] -0.5083198 0.2583890 -0.1313442 0.06676487 -0.033937906
[2,] -1.2867476 1.6557194 -2.1304929 2.74140660 -3.527498342
[3,] -0.3966311 0.1573162 -0.0623965 0.02474839 -0.009815981
[4,]  1.3212573 1.7457208  2.3065463 3.04754115  4.026585945
[5,] -1.3201219 1.7427217 -2.3006050 3.03707893 -4.009314257
</pre>
</div>
</div>

<div id="outline-container-orgheadline32" class="outline-3">
<h3 id="orgheadline32"><span class="section-number-3">5.3</span> <code>Reduce</code></h3>
<div class="outline-text-3" id="text-5-3">
<ul class="org-ul">
<li>Combina sucesivamente los elementos de un objeto aplicando una
función binaria</li>
</ul>
<div class="org-src-container">

<pre class="src src-R"><span class="org-comment-delimiter">## </span><span class="org-comment">(((1+2)+3)+4)+5</span>
Reduce(<span class="org-string">'+'</span>, 1:5)
<span class="org-comment-delimiter">## </span><span class="org-comment">equivalente a </span>
<span class="org-comment-delimiter">## </span><span class="org-comment">sum(1:10)</span>
</pre>
</div>

<pre class="example">
[1] 15
</pre>
</div>
</div>

<div id="outline-container-orgheadline33" class="outline-3">
<h3 id="orgheadline33"><span class="section-number-3">5.4</span> <code>Reduce</code></h3>
<div class="outline-text-3" id="text-5-4">
<div class="org-src-container">

<pre class="src src-R"><span class="org-comment-delimiter">## </span><span class="org-comment">(((1/2)/3)/4)/5</span>
Reduce(<span class="org-string">'/'</span>, 1:5)
</pre>
</div>

<pre class="example">
[1] 0.008333333
</pre>

<div class="org-src-container">

<pre class="src src-R"><span class="org-function-name">foo</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>(u, v)u + 1 /v
Reduce(foo, c(3, 7, 15, 1, 292))
<span class="org-comment-delimiter">## </span><span class="org-comment">equivalente a</span>
<span class="org-comment-delimiter">## </span><span class="org-comment">foo(foo(foo(foo(3, 7), 15), 1), 292)</span>
</pre>
</div>

<pre class="example">
[1] 4.212948
</pre>

<div class="org-src-container">

<pre class="src src-R">Reduce(foo, c(3, 7, 15, 1, 292), right=<span class="org-type">TRUE</span>)
<span class="org-comment-delimiter">## </span><span class="org-comment">equivalente a</span>
<span class="org-comment-delimiter">## </span><span class="org-comment">foo(3, foo(7, foo(15, foo(1, 292))))</span>
</pre>
</div>

<pre class="example">
[1] 3.141593
</pre>
</div>
</div>

<div id="outline-container-orgheadline34" class="outline-3">
<h3 id="orgheadline34"><span class="section-number-3">5.5</span> Funciones recursivas</h3>
<div class="outline-text-3" id="text-5-5">
<ul class="org-ul">
<li><a href="http://en.wikibooks.org/wiki/R_Programming/Working_with_functions#Functions_as_Objects">Serie de Fibonnaci</a></li>
</ul>
<div class="org-src-container">

<pre class="src src-R"><span class="org-function-name">fib</span> <span class="org-constant">&lt;-</span> <span class="org-keyword">function</span>(n){
    <span class="org-keyword">if</span> (n&gt;2) {
        c(fib(n-1),
          sum(tail(fib(n-1),2)))
    } <span class="org-keyword">else</span> <span class="org-keyword">if</span> (n&gt;=0) rep(1,n)
}
</pre>
</div>

<div class="org-src-container">

<pre class="src src-R">fib(10)
</pre>
</div>

<pre class="example">
[1]  1  1  2  3  5  8 13 21 34 55
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Autor: Oscar Perpiñán Lamigueiro \\ <a href="http://oscarperpinan.github.io/">http://oscarperpinan.github.io/</a></p>
<p class="date">Created: 2016-03-06 dom 17:02</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
