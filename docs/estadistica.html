<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es">
<head>
<title>Estadística básica con R</title>
<!-- 2015-05-07 jue 12:34 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Oscar Perpiñán Lamigueiro \\ [[http://oscarperpinan.github.io]]" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Estadística básica con R</h1>
<div id="table-of-contents">
<h2>&Iacute;ndice</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Conjunto de datos</a>
<ul>
<li><a href="#sec-1-1">1.1. Conjunto de datos: swiss</a></li>
<li><a href="#sec-1-2">1.2. Conjunto de datos: swiss</a></li>
<li><a href="#sec-1-3">1.3. </a></li>
</ul>
</li>
<li><a href="#sec-2">2. Estadística Univariante</a>
<ul>
<li><a href="#sec-2-1">2.1. Resumen de  información</a></li>
<li><a href="#sec-2-2">2.2. Media</a></li>
<li><a href="#sec-2-3">2.3. Desviación Estándar</a></li>
<li><a href="#sec-2-4">2.4. Otras</a></li>
</ul>
</li>
<li><a href="#sec-3">3. Generar datos aleatorios</a>
<ul>
<li><a href="#sec-3-1">3.1. Distribuciones disponibles</a></li>
<li><a href="#sec-3-2">3.2. Densidad, CDF, Cuantiles, y Números aleatorios</a></li>
<li><a href="#sec-3-3">3.3. Distribución Normal</a></li>
<li><a href="#sec-3-4">3.4. Distribución Normal</a></li>
<li><a href="#sec-3-5">3.5. Distribución Uniforme</a></li>
<li><a href="#sec-3-6">3.6. Distribución de Weibull</a></li>
<li><a href="#sec-3-7">3.7. Muestreo aleatorio</a></li>
</ul>
</li>
<li><a href="#sec-4">4. Tests de Hipótesis</a>
<ul>
<li><a href="#sec-4-1">4.1. Para muestra única</a></li>
<li><a href="#sec-4-2">4.2. Para muestras pareadas</a></li>
<li><a href="#sec-4-3">4.3. Para muestras pareadas</a></li>
</ul>
</li>
<li><a href="#sec-5">5. Regresión lineal</a>
<ul>
<li><a href="#sec-5-1">5.1. Fertilidad y educación</a></li>
<li><a href="#sec-5-2">5.2. Fertilidad y educación</a></li>
<li><a href="#sec-5-3">5.3. Fertilidad y educación</a></li>
<li><a href="#sec-5-4">5.4. Fertilidad y educación</a></li>
<li><a href="#sec-5-5">5.5. Fertilidad, educación y religión</a></li>
<li><a href="#sec-5-6">5.6. Lo mismo con <code>update</code></a></li>
<li><a href="#sec-5-7">5.7. Fertilidad, educación, religión y agricultura</a></li>
<li><a href="#sec-5-8">5.8. Lo mismo con <code>update</code></a></li>
<li><a href="#sec-5-9">5.9. Lo mismo con <code>update</code></a></li>
<li><a href="#sec-5-10">5.10. Comparamos modelos con <code>anova</code></a></li>
<li><a href="#sec-5-11">5.11. Fertilidad contra todo</a></li>
<li><a href="#sec-5-12">5.12. Elegir un modelo con <code>anova</code></a></li>
<li><a href="#sec-5-13">5.13. Elegir un modelo con <code>step</code></a></li>
<li><a href="#sec-5-14">5.14. Elegir un modelo</a></li>
<li><a href="#sec-5-15">5.15. Elegir un modelo</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Conjunto de datos</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Conjunto de datos: swiss</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Standardized fertility measure and socio-economic indicators for
each of 47 French-speaking provinces of Switzerland at
about 1888. 6 variables in percent [0, 100]:
</p>

<ul class="org-ul">
<li><b>Fertility</b>:         Ig, ‘common standardized fertility measure’      
</li>
<li><b>Agriculture</b>:       % of males involved in agriculture as occupation 
</li>
<li><b>Examination</b>:       % draftees receiving highest mark on army examination 
</li>
<li><b>Education</b>:         % education beyond primary school for draftees. 
</li>
<li><b>Catholic</b>:          % ‘catholic’ (as opposed to ‘protestant’).      
</li>
<li><b>Infant.Mortality</b>:  live births who live less than 1year.           
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Conjunto de datos: swiss</h3>
<div class="outline-text-3" id="text-1-2">
<div class="org-src-container">

<pre class="src src-R">data(swiss)

summary(swiss)
</pre>
</div>

<pre class="example">
   Fertility      Agriculture     Examination      Education    
 Min.   :35.00   Min.   : 1.20   Min.   : 3.00   Min.   : 1.00  
 1st Qu.:64.70   1st Qu.:35.90   1st Qu.:12.00   1st Qu.: 6.00  
 Median :70.40   Median :54.10   Median :16.00   Median : 8.00  
 Mean   :70.14   Mean   :50.66   Mean   :16.49   Mean   :10.98  
 3rd Qu.:78.45   3rd Qu.:67.65   3rd Qu.:22.00   3rd Qu.:12.00  
 Max.   :92.50   Max.   :89.70   Max.   :37.00   Max.   :53.00  
    Catholic       Infant.Mortality
 Min.   :  2.150   Min.   :10.80   
 1st Qu.:  5.195   1st Qu.:18.15   
 Median : 15.140   Median :20.00   
 Mean   : 41.144   Mean   :19.94   
 3rd Qu.: 93.125   3rd Qu.:21.70   
 Max.   :100.000   Max.   :26.60
</pre>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> </h3>
<div class="outline-text-3" id="text-1-3">
<div class="org-src-container">

<pre class="src src-R"><span class="org-constant">library</span>(lattice)
splom(swiss, pscale=0, type=c(<span class="org-string">'p'</span>, <span class="org-string">'smooth'</span>),
      groups=swiss$Catholic &gt; 50, xlab=<span class="org-string">''</span>)
</pre>
</div>


<div class="figure">
<p><img src="figs/splomSwiss.png" alt="splomSwiss.png" />
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Estadística Univariante</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Resumen de  información</h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">

<pre class="src src-R">summary(swiss)
</pre>
</div>

<pre class="example">
   Fertility      Agriculture     Examination      Education    
 Min.   :35.00   Min.   : 1.20   Min.   : 3.00   Min.   : 1.00  
 1st Qu.:64.70   1st Qu.:35.90   1st Qu.:12.00   1st Qu.: 6.00  
 Median :70.40   Median :54.10   Median :16.00   Median : 8.00  
 Mean   :70.14   Mean   :50.66   Mean   :16.49   Mean   :10.98  
 3rd Qu.:78.45   3rd Qu.:67.65   3rd Qu.:22.00   3rd Qu.:12.00  
 Max.   :92.50   Max.   :89.70   Max.   :37.00   Max.   :53.00  
    Catholic       Infant.Mortality
 Min.   :  2.150   Min.   :10.80   
 1st Qu.:  5.195   1st Qu.:18.15   
 Median : 15.140   Median :20.00   
 Mean   : 41.144   Mean   :19.94   
 3rd Qu.: 93.125   3rd Qu.:21.70   
 Max.   :100.000   Max.   :26.60
</pre>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> Media</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">

<pre class="src src-R">mean(swiss$Fertility)
</pre>
</div>

<pre class="example">
[1] 70.14255
</pre>

<div class="org-src-container">

<pre class="src src-R">colMeans(swiss)
</pre>
</div>

<pre class="example">
Fertility      Agriculture      Examination        Education 
 70.14255         50.65957         16.48936         10.97872 
 Catholic Infant.Mortality 
 41.14383         19.94255
</pre>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> Desviación Estándar</h3>
<div class="outline-text-3" id="text-2-3">
<div class="org-src-container">

<pre class="src src-R">sd(swiss$Fertility)
</pre>
</div>

<pre class="example">
[1] 12.4917
</pre>

<div class="org-src-container">

<pre class="src src-R">sapply(swiss, sd)
</pre>
</div>

<pre class="example">
Fertility      Agriculture      Examination        Education 
12.491697        22.711218         7.977883         9.615407 
 Catholic Infant.Mortality 
41.704850         2.912697
</pre>
</div>
</div>

<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4"><span class="section-number-3">2.4</span> Otras</h3>
<div class="outline-text-3" id="text-2-4">
<div class="org-src-container">

<pre class="src src-R">median(swiss$Fertility)
</pre>
</div>

<pre class="example">
[1] 70.4
</pre>

<div class="org-src-container">

<pre class="src src-R">mad(swiss$Fertility)
</pre>
</div>

<pre class="example">
[1] 10.22994
</pre>

<div class="org-src-container">

<pre class="src src-R">IQR(swiss$Fertility)
</pre>
</div>

<pre class="example">
[1] 13.75
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Generar datos aleatorios</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> Distribuciones disponibles</h3>
<div class="outline-text-3" id="text-3-1">
</div><ol class="org-ol"><li>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="BMCOL">BMCOL</span></span><br  /><div class="outline-text-4" id="text-3-1-1">
<ul class="org-ul">
<li>beta <code>beta</code>
</li>
<li>binomial <code>binom</code>
</li>
<li>Cauchy <code>cauchy</code>
</li>
<li>chi-squared <code>chisq</code>
</li>
<li>exponential <code>exp</code>
</li>
<li>F <code>f</code>
</li>
<li>gamma <code>gamma</code>
</li>
<li>geometric <code>geom</code>
</li>
<li>hypergeometric <code>hyper</code>
</li>
</ul>
</div>
</li>
<li>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="BMCOL">BMCOL</span></span><br  /><div class="outline-text-4" id="text-3-1-2">
<ul class="org-ul">
<li>log-normal <code>lnorm</code>
</li>
<li>logistic <code>logis</code>
</li>
<li>negative <code>binomial</code>
</li>
<li>normal <code>norm</code>
</li>
<li>Poisson <code>pois</code>
</li>
<li>signed rank <code>signrank</code>
</li>
<li>Student’s t <code>t</code>
</li>
<li>uniform <code>unif</code>
</li>
<li>Weibull <code>weibull</code>
</li>
<li>Wilcoxon <code>wilcox</code>
</li>
</ul>
</div>
</li></ol>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> Densidad, CDF, Cuantiles, y Números aleatorios</h3>
<div class="outline-text-3" id="text-3-2">
<dl class="org-dl">
<dt> <code>dxxx</code> </dt><dd>función de densidad de probabilidad
</dd>
<dt> <code>pxxx</code> </dt><dd>función acumulada de probabilidad
</dd>
<dt> <code>qxxx</code> </dt><dd>cuantiles
</dd>
<dt> <code>rxxx</code> </dt><dd>generación de números aleatorios
</dd>
</dl>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> Distribución Normal</h3>
<div class="outline-text-3" id="text-3-3">
<div class="org-src-container">

<pre class="src src-R">rnorm(10, mean = 1, sd = .4)
</pre>
</div>

<pre class="example">
[1] 0.5987165 0.7374486 1.0635955 0.2232172 1.0509421 0.9659542 0.5948662
[8] 0.8766249 1.0982419 0.9985146
</pre>

<div class="org-src-container">

<pre class="src src-R">hist(rnorm(1e6, mean = 1, sd = .4))
</pre>
</div>


<div class="figure">
<p><img src="figs/rnorm.png" alt="rnorm.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4"><span class="section-number-3">3.4</span> Distribución Normal</h3>
<div class="outline-text-3" id="text-3-4">
<div class="org-src-container">

<pre class="src src-R">x <span class="org-constant">&lt;-</span> seq( -5, 5, by =.01)
plot(x, dnorm(x), type = <span class="org-string">'l'</span>)
</pre>
</div>


<div class="figure">
<p><img src="figs/dnorm.png" alt="dnorm.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3-5" class="outline-3">
<h3 id="sec-3-5"><span class="section-number-3">3.5</span> Distribución Uniforme</h3>
<div class="outline-text-3" id="text-3-5">
<div class="org-src-container">

<pre class="src src-R">runif(10, min=-3, max=3)
</pre>
</div>

<pre class="example">
[1]  1.2153711 -2.8451359  0.8235075 -1.0147079 -1.7177479 -1.3571362
[7]  2.7228768  0.2771958  0.7458442 -1.8732231
</pre>


<div class="org-src-container">

<pre class="src src-R">hist(runif(1e6, min = -3, max = 3))
</pre>
</div>


<div class="figure">
<p><img src="figs/runif.png" alt="runif.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3-6" class="outline-3">
<h3 id="sec-3-6"><span class="section-number-3">3.6</span> Distribución de Weibull</h3>
<div class="outline-text-3" id="text-3-6">
<div class="org-src-container">

<pre class="src src-R">rweibull(n=10, shape = 3, scale = 2)
</pre>
</div>

<pre class="example">
[1] 0.7661914 1.3502844 0.9237997 1.8538150 1.8644202 2.5229566 1.6498369
[8] 1.8534614 1.9982788 2.7837383
</pre>


<div class="org-src-container">

<pre class="src src-R">hist(rweibull(1e6, shape = 3, scale = 2))
</pre>
</div>


<div class="figure">
<p><img src="figs/rweibull.png" alt="rweibull.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3-7" class="outline-3">
<h3 id="sec-3-7"><span class="section-number-3">3.7</span> Muestreo aleatorio</h3>
<div class="outline-text-3" id="text-3-7">
<div class="org-src-container">

<pre class="src src-R">x <span class="org-constant">&lt;-</span> seq(1, 100, length = 10)
x
</pre>
</div>

<pre class="example">
[1]   1  12  23  34  45  56  67  78  89 100
</pre>

<ul class="org-ul">
<li>Sin reemplazo
</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">sample(x)
</pre>
</div>

<pre class="example">
[1]  12  23  45  78   1 100  34  89  67  56
</pre>

<div class="org-src-container">

<pre class="src src-R">sample(x, 5)
</pre>
</div>

<pre class="example">
[1]  89 100  56  23  12
</pre>

<ul class="org-ul">
<li>Con reemplazo
</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">sample(x, 5, replace = <span class="org-type">TRUE</span>)
</pre>
</div>

<pre class="example">
[1]  1 56 89 45 89
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Tests de Hipótesis</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> Para muestra única</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li>t de Student
</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">t.test(swiss$Fertility, mu=70)
</pre>
</div>

<pre class="example">
	One Sample t-test

data:  swiss$Fertility
t = 0.078236, df = 46, p-value = 0.938
alternative hypothesis: true mean is not equal to 70
95 percent confidence interval:
 66.47485 73.81025
sample estimates:
mean of x 
 70.14255
</pre>

<ul class="org-ul">
<li>Wilcoxon (no paramétrico)
</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">wilcox.test(swiss$Fertility, mu=70)
</pre>
</div>

<pre class="example">
	Wilcoxon signed rank test with continuity correction

data:  swiss$Fertility
V = 592.5, p-value = 0.767
alternative hypothesis: true location is not equal to 70

Warning message:
In wilcox.test.default(swiss$Fertility, mu = 70) :
  cannot compute exact p-value with ties
</pre>
</div>
</div>

<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2"><span class="section-number-3">4.2</span> Para muestras pareadas</h3>
<div class="outline-text-3" id="text-4-2">
<div class="org-src-container">

<pre class="src src-R">Religion <span class="org-constant">&lt;-</span> ifelse(swiss$Catholic &gt; 50,
                   <span class="org-string">'Catholic'</span>, <span class="org-string">'Protestant'</span>)
</pre>
</div>

<ul class="org-ul">
<li>t de Student
</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">t.test(Fertility ~ Religion, data=swiss)
</pre>
</div>

<pre class="example">
	Welch Two Sample t-test

data:  Fertility by Religion
t = 2.7004, df = 26.742, p-value = 0.01186
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
  2.455904 18.024939
sample estimates:
  mean in group Catholic mean in group Protestant 
                76.46111                 66.22069
</pre>
</div>
</div>

<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3"><span class="section-number-3">4.3</span> Para muestras pareadas</h3>
<div class="outline-text-3" id="text-4-3">
<ul class="org-ul">
<li>Wilcoxon
</li>
</ul>
<div class="org-src-container">

<pre class="src src-R">wilcox.test(Fertility ~ Religion, data=swiss)
</pre>
</div>

<pre class="example">
	Wilcoxon rank sum test with continuity correction

data:  Fertility by Religion
W = 409.5, p-value = 0.0012
alternative hypothesis: true location shift is not equal to 0

Warning message:
In wilcox.test.default(x = c(83.1, 92.5, 76.1, 83.8, 92.4, 82.4,  :
  cannot compute exact p-value with ties
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Regresión lineal</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1"><span class="section-number-3">5.1</span> Fertilidad y educación</h3>
<div class="outline-text-3" id="text-5-1">
<div class="org-src-container">

<pre class="src src-R">lmFertEdu <span class="org-constant">&lt;-</span> lm(Fertility ~ Education,
              data = swiss)
summary(lmFertEdu)
</pre>
</div>

<pre class="example">
Call:
lm(formula = Fertility ~ Education, data = swiss)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.036  -6.711  -1.011   9.526  19.689 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  79.6101     2.1041  37.836  &lt; 2e-16 ***
Education    -0.8624     0.1448  -5.954 3.66e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 9.446 on 45 degrees of freedom
Multiple R-squared:  0.4406,	Adjusted R-squared:  0.4282 
F-statistic: 35.45 on 1 and 45 DF,  p-value: 3.659e-07
</pre>
</div>
</div>

<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2"><span class="section-number-3">5.2</span> Fertilidad y educación</h3>
<div class="outline-text-3" id="text-5-2">
<div class="org-src-container">

<pre class="src src-R">coef(lmFertEdu)
</pre>
</div>

<pre class="example">
(Intercept)   Education 
 79.6100585  -0.8623503
</pre>

<div class="org-src-container">

<pre class="src src-R">fitted.values(lmFertEdu)
</pre>
</div>

<pre class="example">
  Courtelary     Delemont Franches-Mnt      Moutier   Neuveville   Porrentruy 
    69.26186     71.84891     75.29831     73.57361     66.67480     73.57361 
       Broye        Glane      Gruyere       Sarine      Veveyse        Aigle 
    73.57361     72.71126     73.57361     68.39950     74.43596     69.26186 
     Aubonne     Avenches     Cossonay    Echallens     Grandson     Lausanne 
    73.57361     69.26186     75.29831     77.88536     72.71126     55.46425 
   La Vallee       Lavaux       Morges       Moudon        Nyone         Orbe 
    62.36305     71.84891     70.98656     77.02301     69.26186     74.43596 
        Oron      Payerne Paysd'enhaut        Rolle        Vevey      Yverdon 
    78.74771     72.71126     77.02301     70.98656     63.22540     72.71126 
     Conthey    Entremont       Herens     Martigwy      Monthey   St Maurice 
    77.88536     74.43596     77.88536     74.43596     77.02301     71.84891 
      Sierre         Sion       Boudry La Chauxdfnd     Le Locle    Neuchatel 
    77.02301     68.39950     69.26186     70.12421     68.39950     52.01485 
  Val de Ruz ValdeTravers V. De Geneve  Rive Droite  Rive Gauche 
    73.57361     73.57361     33.90549     54.60190     54.60190
</pre>
</div>
</div>

<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3"><span class="section-number-3">5.3</span> Fertilidad y educación</h3>
<div class="outline-text-3" id="text-5-3">
<div class="org-src-container">

<pre class="src src-R">residuals(lmFertEdu)
</pre>
</div>

<pre class="example">
  Courtelary     Delemont Franches-Mnt      Moutier   Neuveville   Porrentruy 
  10.9381450   11.2510941   17.2016929   12.2263935   10.2251959    2.5263935 
       Broye        Glane      Gruyere       Sarine      Veveyse        Aigle 
  10.2263935   19.6887438    8.8263935   14.5004953   12.6640432   -5.1618550 
     Aubonne     Avenches     Cossonay    Echallens     Grandson     Lausanne 
  -6.6736065   -0.3618550  -13.5983071   -9.5853579   -1.0112562    0.2357497 
   La Vallee       Lavaux       Morges       Moudon        Nyone         Orbe 
  -8.0630527   -6.7489059   -5.4865556  -12.0230077  -12.6618550  -17.0359568 
        Oron      Payerne Paysd'enhaut        Rolle        Vevey      Yverdon 
  -6.2477082    1.4887438   -5.0230077  -10.4865556   -4.9254030   -7.3112562 
     Conthey    Entremont       Herens     Martigwy      Monthey   St Maurice 
  -2.3853579   -5.1359568   -0.5853579   -3.9359568    2.3769923   -6.8489059 
      Sierre         Sion       Boudry La Chauxdfnd     Le Locle    Neuchatel 
  15.1769923   10.9004953    1.1381450   -4.4242053    4.3004953   12.3851508 
  Val de Ruz ValdeTravers V. De Geneve  Rive Droite  Rive Gauche 
   4.0263935   -5.9736065    1.0945070   -9.9019000  -11.8019000
</pre>
</div>
</div>

<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4"><span class="section-number-3">5.4</span> Fertilidad y educación</h3>
<div class="outline-text-3" id="text-5-4">
<div class="org-src-container">

<pre class="src src-R">plot(lmFertEdu, which = 1)
</pre>
</div>


<div class="figure">
<p><img src="figs/lmFertEdu.png" alt="lmFertEdu.png" />
</p>
</div>
</div>
</div>



<div id="outline-container-sec-5-5" class="outline-3">
<h3 id="sec-5-5"><span class="section-number-3">5.5</span> Fertilidad, educación y religión</h3>
<div class="outline-text-3" id="text-5-5">
<div class="org-src-container">

<pre class="src src-R">lmFertEduCat <span class="org-constant">&lt;-</span> lm(Fertility ~ Education + Catholic,
                   data = swiss)
summary(lmFertEduCat)
</pre>
</div>

<pre class="example">
Call:
lm(formula = Fertility ~ Education + Catholic, data = swiss)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.042  -6.578  -1.431   6.122  14.322 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 74.23369    2.35197  31.562  &lt; 2e-16 ***
Education   -0.78833    0.12929  -6.097 2.43e-07 ***
Catholic     0.11092    0.02981   3.721  0.00056 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 8.331 on 44 degrees of freedom
Multiple R-squared:  0.5745,	Adjusted R-squared:  0.5552 
F-statistic:  29.7 on 2 and 44 DF,  p-value: 6.849e-09
</pre>
</div>
</div>


<div id="outline-container-sec-5-6" class="outline-3">
<h3 id="sec-5-6"><span class="section-number-3">5.6</span> Lo mismo con <code>update</code></h3>
<div class="outline-text-3" id="text-5-6">
<div class="org-src-container">

<pre class="src src-R">lmFertEduCat <span class="org-constant">&lt;-</span> update(lmFertEdu, . ~ . + Catholic,
                       data = swiss)
summary(lmFertEduCat)
</pre>
</div>

<pre class="example">
Call:
lm(formula = Fertility ~ Education + Catholic, data = swiss)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.042  -6.578  -1.431   6.122  14.322 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 74.23369    2.35197  31.562  &lt; 2e-16 ***
Education   -0.78833    0.12929  -6.097 2.43e-07 ***
Catholic     0.11092    0.02981   3.721  0.00056 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 8.331 on 44 degrees of freedom
Multiple R-squared:  0.5745,	Adjusted R-squared:  0.5552 
F-statistic:  29.7 on 2 and 44 DF,  p-value: 6.849e-09
</pre>
</div>
</div>


<div id="outline-container-sec-5-7" class="outline-3">
<h3 id="sec-5-7"><span class="section-number-3">5.7</span> Fertilidad, educación, religión y agricultura</h3>
<div class="outline-text-3" id="text-5-7">
<div class="org-src-container">

<pre class="src src-R">lmFertEduCatAgr <span class="org-constant">&lt;-</span> lm(Fertility ~ Education + Catholic + Agriculture,
                      data = swiss)
summary(lmFertEduCatAgr)
</pre>
</div>

<pre class="example">
Call:
lm(formula = Fertility ~ Education + Catholic + Agriculture, 
    data = swiss)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.178  -6.548   1.379   5.822  14.840 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 86.22502    4.73472  18.211  &lt; 2e-16 ***
Education   -1.07215    0.15580  -6.881 1.91e-08 ***
Catholic     0.14520    0.03015   4.817 1.84e-05 ***
Agriculture -0.20304    0.07115  -2.854  0.00662 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 7.728 on 43 degrees of freedom
Multiple R-squared:  0.6423,	Adjusted R-squared:  0.6173 
F-statistic: 25.73 on 3 and 43 DF,  p-value: 1.089e-09
</pre>
</div>
</div>


<div id="outline-container-sec-5-8" class="outline-3">
<h3 id="sec-5-8"><span class="section-number-3">5.8</span> Lo mismo con <code>update</code></h3>
<div class="outline-text-3" id="text-5-8">
<div class="org-src-container">

<pre class="src src-R">lmFertEduCatAgr <span class="org-constant">&lt;-</span> update(lmFertEduCat,
                          . ~ . + Agriculture,
                          data = swiss)
summary(lmFertEduCatAgr)
</pre>
</div>

<pre class="example">
Call:
lm(formula = Fertility ~ Education + Catholic + Agriculture, 
    data = swiss)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.178  -6.548   1.379   5.822  14.840 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 86.22502    4.73472  18.211  &lt; 2e-16 ***
Education   -1.07215    0.15580  -6.881 1.91e-08 ***
Catholic     0.14520    0.03015   4.817 1.84e-05 ***
Agriculture -0.20304    0.07115  -2.854  0.00662 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 7.728 on 43 degrees of freedom
Multiple R-squared:  0.6423,	Adjusted R-squared:  0.6173 
F-statistic: 25.73 on 3 and 43 DF,  p-value: 1.089e-09
</pre>
</div>
</div>

<div id="outline-container-sec-5-9" class="outline-3">
<h3 id="sec-5-9"><span class="section-number-3">5.9</span> Lo mismo con <code>update</code></h3>
<div class="outline-text-3" id="text-5-9">
<div class="org-src-container">

<pre class="src src-R">lmFertEduCatAgr <span class="org-constant">&lt;-</span> update(lmFertEdu,
                          . ~ . + Catholic + Agriculture,
                          data = swiss)
summary(lmFertEduCatAgr)
</pre>
</div>

<pre class="example">
Call:
lm(formula = Fertility ~ Education + Catholic + Agriculture, 
    data = swiss)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.178  -6.548   1.379   5.822  14.840 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 86.22502    4.73472  18.211  &lt; 2e-16 ***
Education   -1.07215    0.15580  -6.881 1.91e-08 ***
Catholic     0.14520    0.03015   4.817 1.84e-05 ***
Agriculture -0.20304    0.07115  -2.854  0.00662 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 7.728 on 43 degrees of freedom
Multiple R-squared:  0.6423,	Adjusted R-squared:  0.6173 
F-statistic: 25.73 on 3 and 43 DF,  p-value: 1.089e-09
</pre>
</div>
</div>

<div id="outline-container-sec-5-10" class="outline-3">
<h3 id="sec-5-10"><span class="section-number-3">5.10</span> Comparamos modelos con <code>anova</code></h3>
<div class="outline-text-3" id="text-5-10">
<div class="org-src-container">

<pre class="src src-R">anova(lmFertEdu, lmFertEduCat, lmFertEduCatAgr)
</pre>
</div>

<pre class="example">
Analysis of Variance Table

Model 1: Fertility ~ Education
Model 2: Fertility ~ Education + Catholic
Model 3: Fertility ~ Education + Catholic + Agriculture
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1     45 4015.2                                  
2     44 3054.2  1    961.07 16.093 0.0002365 ***
3     43 2567.9  1    486.28  8.143 0.0066235 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre>
</div>
</div>

<div id="outline-container-sec-5-11" class="outline-3">
<h3 id="sec-5-11"><span class="section-number-3">5.11</span> Fertilidad contra todo</h3>
<div class="outline-text-3" id="text-5-11">
<div class="org-src-container">

<pre class="src src-R">lmFert <span class="org-constant">&lt;-</span> lm(Fertility ~ ., data=swiss)

summary(lmFert)
</pre>
</div>

<pre class="example">
Call:
lm(formula = Fertility ~ ., data = swiss)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.2743  -5.2617   0.5032   4.1198  15.3213 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      66.91518   10.70604   6.250 1.91e-07 ***
Agriculture      -0.17211    0.07030  -2.448  0.01873 *  
Examination      -0.25801    0.25388  -1.016  0.31546    
Education        -0.87094    0.18303  -4.758 2.43e-05 ***
Catholic          0.10412    0.03526   2.953  0.00519 ** 
Infant.Mortality  1.07705    0.38172   2.822  0.00734 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 7.165 on 41 degrees of freedom
Multiple R-squared:  0.7067,	Adjusted R-squared:  0.671 
F-statistic: 19.76 on 5 and 41 DF,  p-value: 5.594e-10
</pre>
</div>
</div>

<div id="outline-container-sec-5-12" class="outline-3">
<h3 id="sec-5-12"><span class="section-number-3">5.12</span> Elegir un modelo con <code>anova</code></h3>
<div class="outline-text-3" id="text-5-12">
<div class="org-src-container">

<pre class="src src-R">anova(lmFert)
</pre>
</div>

<pre class="example">
Analysis of Variance Table

Response: Fertility
                 Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
Agriculture       1  894.84  894.84 17.4288 0.0001515 ***
Examination       1 2210.38 2210.38 43.0516 6.885e-08 ***
Education         1  891.81  891.81 17.3699 0.0001549 ***
Catholic          1  667.13  667.13 12.9937 0.0008387 ***
Infant.Mortality  1  408.75  408.75  7.9612 0.0073357 ** 
Residuals        41 2105.04   51.34                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre>
</div>
</div>

<div id="outline-container-sec-5-13" class="outline-3">
<h3 id="sec-5-13"><span class="section-number-3">5.13</span> Elegir un modelo con <code>step</code></h3>
<div class="outline-text-3" id="text-5-13">
<div class="org-src-container">

<pre class="src src-R">stepFert <span class="org-constant">&lt;-</span> step(lmFert)
</pre>
</div>

<pre class="example">
Start:  AIC=190.69
Fertility ~ Agriculture + Examination + Education + Catholic + 
    Infant.Mortality

                   Df Sum of Sq    RSS    AIC
- Examination       1     53.03 2158.1 189.86
&lt;none&gt;                          2105.0 190.69
- Agriculture       1    307.72 2412.8 195.10
- Infant.Mortality  1    408.75 2513.8 197.03
- Catholic          1    447.71 2552.8 197.75
- Education         1   1162.56 3267.6 209.36

Step:  AIC=189.86
Fertility ~ Agriculture + Education + Catholic + Infant.Mortality

                   Df Sum of Sq    RSS    AIC
&lt;none&gt;                          2158.1 189.86
- Agriculture       1    264.18 2422.2 193.29
- Infant.Mortality  1    409.81 2567.9 196.03
- Catholic          1    956.57 3114.6 205.10
- Education         1   2249.97 4408.0 221.43
</pre>
</div>
</div>

<div id="outline-container-sec-5-14" class="outline-3">
<h3 id="sec-5-14"><span class="section-number-3">5.14</span> Elegir un modelo</h3>
<div class="outline-text-3" id="text-5-14">
<div class="org-src-container">

<pre class="src src-R">summary(stepFert)
</pre>
</div>

<pre class="example">
Call:
lm(formula = Fertility ~ Agriculture + Education + Catholic + 
    Infant.Mortality, data = swiss)

Residuals:
     Min       1Q   Median       3Q      Max 
-14.6765  -6.0522   0.7514   3.1664  16.1422 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      62.10131    9.60489   6.466 8.49e-08 ***
Agriculture      -0.15462    0.06819  -2.267  0.02857 *  
Education        -0.98026    0.14814  -6.617 5.14e-08 ***
Catholic          0.12467    0.02889   4.315 9.50e-05 ***
Infant.Mortality  1.07844    0.38187   2.824  0.00722 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 7.168 on 42 degrees of freedom
Multiple R-squared:  0.6993,	Adjusted R-squared:  0.6707 
F-statistic: 24.42 on 4 and 42 DF,  p-value: 1.717e-10
</pre>
</div>
</div>

<div id="outline-container-sec-5-15" class="outline-3">
<h3 id="sec-5-15"><span class="section-number-3">5.15</span> Elegir un modelo</h3>
<div class="outline-text-3" id="text-5-15">
<div class="org-src-container">

<pre class="src src-R">stepFert$anova
</pre>
</div>

<pre class="example">
           Step Df Deviance Resid. Df Resid. Dev      AIC
1               NA       NA        41   2105.043 190.6913
2 - Examination  1 53.02656        42   2158.069 189.8606
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Autor: Oscar Perpiñán Lamigueiro \\ <a href="http://oscarperpinan.github.io">http://oscarperpinan.github.io</a></p>
<p class="date">Created: 2015-05-07 jue 12:34</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.4.1 (<a href="http://orgmode.org">Org</a> mode 8.2.7c)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
