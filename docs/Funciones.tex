% Created 2017-06-29 jue 09:07
% Intended LaTeX compiler: pdflatex
\documentclass[xcolor={usenames,svgnames,dvipsnames}]{beamer}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{capt-of}
\usepackage{hyperref}
\usepackage{color}
\usepackage{listings}
\usepackage[spanish]{babel}
\usecolortheme{rose}
\setbeamercolor{alerted text}{fg=Blue}
\setbeamerfont{alerted text}{series=\bfseries}
\setbeamercolor{block title}{bg=structure.fg!20!bg!50!bg}
\setbeamercolor{block body}{use=block title,bg=block title.bg}
\setbeamertemplate{navigation symbols}{}
\AtBeginSubsection[]{\begin{frame}[plain]\tableofcontents[currentsubsection,sectionstyle=show/shaded,subsectionstyle=show/shaded/hide]\end{frame}}
\lstset{keywordstyle=\color{blue}, commentstyle=\color{gray!90}, basicstyle=\ttfamily\small, columns=fullflexible, breaklines=true,linewidth=\textwidth, backgroundcolor=\color{gray!23}, basewidth={0.5em,0.4em}, literate={á}{{\'a}}1 {ñ}{{\~n}}1 {é}{{\'e}}1 {ó}{{\'o}}1 {º}{{\textordmasculine}}1, showstringspaces=false}
\usepackage{mathpazo}
\hypersetup{colorlinks=true, linkcolor=Blue, urlcolor=Blue}
\usepackage{fancyvrb}
\DefineVerbatimEnvironment{verbatim}{Verbatim}{fontsize=\tiny, formatcom = {\color{black!70}}}
\AtBeginSection[]{\begin{frame}[plain]\tableofcontents[currentsection,sectionstyle=show/shaded]\end{frame}}
\usetheme{Goettingen}
\usefonttheme{serif}
\author{Oscar Perpiñán Lamigueiro $\backslash$\ \url{http://oscarperpinan.github.io}}
\date{}
\title{Funciones}
\hypersetup{
 pdfauthor={Oscar Perpiñán Lamigueiro $\backslash$\ \url{http://oscarperpinan.github.io}},
 pdftitle={Funciones},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 24.5.1 (Org mode 9.0.5)}, 
 pdflang={Spanish}}
\begin{document}

\maketitle


\section{Conceptos Básicos}
\label{sec:orgdf7c3d3}

\begin{frame}[label={sec:org1c1630f}]{Fuentes de información}
\begin{itemize}
\item \href{http://cran.r-project.org/doc/manuals/R-intro.html}{R introduction}
\item \href{http://cran.r-project.org/doc/manuals/R-lang.html}{R Language Definition}
\item \href{http://www.springer.com/gb/book/9780387759357}{Software for Data Analysis}
\end{itemize}
\end{frame}
\begin{frame}[fragile,label={sec:org882aa46}]{Componentes de una función}
 \begin{itemize}
\item Una función se define con \texttt{function}
\end{itemize}
\begin{center}
\texttt{name <- function(arg\_1, arg\_2, ...) expression}
\end{center}
\begin{itemize}
\item Está compuesta por:
\begin{itemize}
\item Nombre de la función (\texttt{name})
\item Argumentos (\texttt{arg\_1}, \texttt{arg\_2}, \texttt{...})
\item Cuerpo (\texttt{expression}): emplea los argumentos para generar un resultado
\end{itemize}
\end{itemize}
\end{frame}
\begin{frame}[fragile,label={sec:org7acf5bd}]{Mi primera función}
 \begin{itemize}
\item Definición
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
myFun <- function(x, y)
{
    x + y
}
\end{lstlisting}

\begin{itemize}
\item Argumentos
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
formals(myFun)
\end{lstlisting}

\begin{verbatim}
$x


$y
\end{verbatim}

\begin{itemize}
\item Cuerpo
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
body(myFun)
\end{lstlisting}

\begin{verbatim}
{
    x + y
}
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:org6f93e61}]{Mi primera función}
 \lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
myFun(1, 2)
\end{lstlisting}

\begin{verbatim}
[1] 3
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
myFun(1:10, 21:30)
\end{lstlisting}

\begin{verbatim}
[1] 22 24 26 28 30 32 34 36 38 40
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
myFun(1:10, 3)
\end{lstlisting}

\begin{verbatim}
[1]  4  5  6  7  8  9 10 11 12 13
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:org30ce366}]{Argumentos: nombre y orden}
 Una función identifica sus argumentos por su nombre y por su orden (sin nombre)

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
power <- function(x, exp)
{
    x^exp
}
\end{lstlisting}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
power(x=1:10, exp=2)
\end{lstlisting}

\begin{verbatim}
[1]   1   4   9  16  25  36  49  64  81 100
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
power(1:10, exp=2)
\end{lstlisting}

\begin{verbatim}
[1]   1   4   9  16  25  36  49  64  81 100
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
power(exp=2, x=1:10)
\end{lstlisting}

\begin{verbatim}
[1]   1   4   9  16  25  36  49  64  81 100
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:org1124e43}]{Argumentos: valores por defecto}
 \begin{itemize}
\item Se puede asignar un valor por defecto a los argumentos
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
power <- function(x, exp = 2)
{
    x ^ exp
}
\end{lstlisting}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
power(1:10)
\end{lstlisting}

\begin{verbatim}
[1]   1   4   9  16  25  36  49  64  81 100
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
power(1:10, 2)
\end{lstlisting}

\begin{verbatim}
[1]   1   4   9  16  25  36  49  64  81 100
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:org7c05457}]{Funciones sin argumentos}
 \lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
hello <- function()
{
    print('Hello world!')
}
\end{lstlisting}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
hello()
\end{lstlisting}

\begin{verbatim}
[1] "Hello world!"
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:org4e94fa8}]{Argumentos sin nombre: \texttt{...}}
 \lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
pwrSum <- function(x, power, ...)
{
    sum(x ^ power, ...)
}
\end{lstlisting}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
x <- 1:10
pwrSum(x, 2)
\end{lstlisting}

\begin{verbatim}
[1] 385
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
x <- c(1:5, NA, 6:9, NA, 10)
pwrSum(x, 2)
\end{lstlisting}

\begin{verbatim}
[1] NA
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
pwrSum(x, 2, na.rm=TRUE)
\end{lstlisting}

\begin{verbatim}
[1] 385
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:org86e5780}]{Argumentos ausentes: \texttt{missing}}
 \lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
suma10 <- function(x, y)
{
    if (missing(y)) y <- 10
    x + y
}
\end{lstlisting}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
suma10(1:10)
\end{lstlisting}

\begin{verbatim}
[1] 11 12 13 14 15 16 17 18 19 20
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:org1e12cc9}]{Control de errores: \texttt{stopifnot}}
 \lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
foo <- function(x, y)
{
    stopifnot(is.numeric(x) & is.numeric(y))
    x + y
}
\end{lstlisting}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
foo(1:10, 21:30)
\end{lstlisting}

\begin{verbatim}
[1] 22 24 26 28 30 32 34 36 38 40
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
foo(1:10, 'a')
\end{lstlisting}

\begin{verbatim}
Error: is.numeric(x) & is.numeric(y) is not TRUE
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:orgcd53aa4}]{Control de errores: \texttt{stop}}
 \lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
foo <- function(x, y){
    if (!(is.numeric(x) & is.numeric(y))){
        stop('arguments must be numeric.')
    } else { x + y }
}
\end{lstlisting}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
foo(2, 3)
\end{lstlisting}

\begin{verbatim}
[1] 5
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
foo(2, 'a')
\end{lstlisting}

\begin{verbatim}
Error in foo(2, "a") : arguments must be numeric.
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:orga1f76b7}]{Mensajes para el usuario}
 \texttt{stop} para la ejecución y emite un mensaje de error
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
stop('Algo no ha ido bien.')
\end{lstlisting}

\begin{verbatim}
Error: Algo no ha ido bien.
\end{verbatim}

\texttt{warning} no interfiere en la ejecución pero añade un mensaje a la cola de advertencias
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
warning('Quizás algo no es como debiera...')
\end{lstlisting}

\begin{verbatim}
Warning message:
Quizás algo no es como debiera...
\end{verbatim}

\texttt{message} emite un mensaje (\alert{no usar \texttt{cat} o \texttt{print}})
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
message('Todo en orden por estos lares.')
\end{lstlisting}

\begin{verbatim}
Todo en orden por estos lares.
\end{verbatim}
\end{frame}

\section{Lexical scope}
\label{sec:org4dbb409}

\begin{frame}[fragile,label={sec:org78093aa}]{Clases de variables}
 Las variables que se emplean en el cuerpo de una función pueden
dividirse en:
\begin{itemize}
\item Parámetros formales (argumentos): \texttt{x}, \texttt{y}
\item Variables locales (definiciones internas): \texttt{z}, \texttt{w}, \texttt{m}
\item Variables libres: \texttt{a}, \texttt{b}
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
myFun <- function(x, y){
    z <- x^2
    w <- y^3
    m <- a*z + b*w
    m
}
\end{lstlisting}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
a <- 10
b <- 20
myFun(2, 3)
\end{lstlisting}

\begin{verbatim}
[1] 580
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:org8efb5c1}]{Lexical scope}
 \begin{itemize}
\item Las variables libres deben estar disponibles en el entorno
(\texttt{environment}) en el que la función ha sido creada.
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
environment(myFun)
\end{lstlisting}

\begin{verbatim}
<environment: R_GlobalEnv>
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
ls()
\end{lstlisting}

\begin{verbatim}
[1] "a"      "b"      "foo"    "hello"  "myFun"  "power"  "pwrSum" "suma10"
[9] "x"
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:org104c124}]{Lexical scope: funciones anidadas}
 \lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
anidada <- function(x, y){
    xn <- 2
    yn <- 3
    interna <- function(x, y)
    {
        sum(x^xn, y^yn)
    }
    print(environment(interna))
    interna(x, y)
}
\end{lstlisting}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
anidada(1:3, 2:4)
\end{lstlisting}

\begin{verbatim}
<environment: 0x55cfbe05dd48>
[1] 113
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
sum((1:3)^2, (2:4)^3)
\end{lstlisting}

\begin{verbatim}
[1] 113
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:org9d96654}]{Lexical scope: funciones anidadas}
 \lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
xn
\end{lstlisting}

\begin{verbatim}
Error: objeto 'xn' no encontrado
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
yn
\end{lstlisting}

\begin{verbatim}
Error: objeto 'yn' no encontrado
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
interna
\end{lstlisting}

\begin{verbatim}
Error: objeto 'interna' no encontrado
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:org7456e09}]{Funciones que devuelven funciones}
 \lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
constructor <- function(m, n){
    function(x)
    {
        m*x + n
    }
}
\end{lstlisting}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
myFoo <- constructor(10, 3)
myFoo
\end{lstlisting}

\begin{verbatim}
function(x)
    {
        m*x + n
    }
<bytecode: 0x55cfbddeef90>
<environment: 0x55cfbddb1af8>
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
## 10*5 + 3
myFoo(5)
\end{lstlisting}

\begin{verbatim}
[1] 53
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:org4ba6aaf}]{Funciones que devuelven funciones}
 \lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
class(myFoo)
\end{lstlisting}

\begin{verbatim}
[1] "function"
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
environment(myFoo)
\end{lstlisting}

\begin{verbatim}
<environment: 0x55cfbddb1af8>
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
ls()
\end{lstlisting}

\begin{verbatim}
 [1] "a"           "anidada"     "b"           "constructor" "foo"        
 [6] "hello"       "myFoo"       "myFun"       "power"       "pwrSum"     
[11] "suma10"      "x"
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
ls(env = environment(myFoo))
\end{lstlisting}

\begin{verbatim}
[1] "m" "n"
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
get('m', env = environment(myFoo))
\end{lstlisting}

\begin{verbatim}
[1] 10
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
get('n', env = environment(myFoo))
\end{lstlisting}

\begin{verbatim}
[1] 3
\end{verbatim}
\end{frame}

\section{Debug}
\label{sec:orgb55c601}

\begin{frame}[fragile,label={sec:org1a0513d}]{Post-mortem: \texttt{traceback}}
 \lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
sumSq <- function(x, ...){
    sum(x ^ 2, ...)
}

sumProd <- function(x, y, ...){
    xs <- sumSq(x, ...)
    ys <- sumSq(y, ...)
    xs * ys
}
\end{lstlisting}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
sumProd(rnorm(10), runif(10))
\end{lstlisting}

\begin{verbatim}
[1] 18.70681
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
sumProd(rnorm(10), letters[1:10])
\end{lstlisting}

\begin{verbatim}
Error in x^2 : argumento no-numérico para operador binario
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
traceback()
\end{lstlisting}

\begin{verbatim}
2: sumSq(y, ...) at #3
1: sumProd(rnorm(10), letters[1:10])
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:orgb812bb5}]{Analizar antes de que ocurra: \texttt{debug}}
 \begin{itemize}
\item Activa la ejecución paso a paso de una función
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
debug(sumProd)
\end{lstlisting}

\begin{itemize}
\item Cada vez que se llame a la función, su cuerpo se ejecuta línea a línea y los resultados de cada paso pueden ser inspeccionados.
\item Los comandos disponibles son:
\begin{itemize}
\item \texttt{n} o intro: avanzar un paso.
\item \texttt{c}: continua hasta el final del contexto actual (por ejemplo,
terminar un bucle).
\item \texttt{where}: entrega la lista de todas las llamadas activas.
\item \texttt{Q}: termina la inspección y vuelve al nivel superior.
\end{itemize}
\item Para desactivar el análisis:
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
undebug(sumProd)
\end{lstlisting}
\end{frame}

\begin{frame}[fragile,label={sec:orgd0c15b8}]{Analizar antes de que ocurra: \texttt{trace}}
 \begin{itemize}
\item \texttt{trace} permite mayor control que \texttt{debug}
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
trace(sumProd, tracer=browser, exit=browser)
\end{lstlisting}

\begin{verbatim}
[1] "sumProd"
\end{verbatim}

\begin{itemize}
\item La función queda modificada
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
sumProd
\end{lstlisting}

\begin{verbatim}
Object with tracing code, class "functionWithTrace"
Original definition: 
function(x, y, ...){
    xs <- sumSq(x, ...)
    ys <- sumSq(y, ...)
    xs * ys
}
<bytecode: 0x55cfbe53c910>

## (to see the tracing code, look at body(object))
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
body(sumProd)
\end{lstlisting}

\begin{verbatim}
{
    on.exit(.doTrace(browser(), "on exit"))
    {
        .doTrace(browser(), "on entry")
        {
            xs <- sumSq(x, ...)
            ys <- sumSq(y, ...)
            xs * ys
        }
    }
}
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:org9582e38}]{Analizar antes de que ocurra: \texttt{trace}}
 \begin{itemize}
\item Los comandos \texttt{n} y \texttt{c} cambian respecto a \texttt{debug}:
\begin{itemize}
\item \texttt{c} o intro: avanzar un paso.
\item \texttt{n}: continua hasta el final del contexto actual (por ejemplo,
terminar un bucle).
\end{itemize}
\item Para desactivar
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
untrace(sumProd)
\end{lstlisting}
\end{frame}

\begin{frame}[label={sec:org2cdcfbd}]{Más recursos}
\begin{itemize}
\item Debugging en RStudio
\begin{itemize}
\item \href{https://support.rstudio.com/hc/en-us/articles/205612627-Debugging-with-RStudio}{Artículo}
\item \href{https://vimeo.com/97831988}{Vídeo}
\end{itemize}
\item \href{http://adv-r.had.co.nz/Exceptions-Debugging.html}{\emph{Debugging} explicado por H. Wickham}
\end{itemize}
\end{frame}

\section{Profiling}
\label{sec:orgc88c0c5}
\begin{frame}[fragile,label={sec:org75d7c23}]{¿Cuánto tarda mi función? \texttt{system.time}}
 \lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
noise <- function(sd)rnorm(1000, mean=0, sd=sd)
\end{lstlisting}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
sumNoise <- function(nComponents){
    vals <- sapply(seq_len(nComponents), noise)
    rowSums(vals)
}
\end{lstlisting}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
system.time(sumNoise(1000))
\end{lstlisting}

\begin{verbatim}
 user  system elapsed 
0.248   0.008   0.258
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:org014ecb8}]{¿Cuánto tarda cada parte de mi función?: \texttt{Rprof}}
 \begin{itemize}
\item Usaremos un fichero temporal
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
tmp <- tempfile()
\end{lstlisting}

\begin{itemize}
\item Activamos la toma de información
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
Rprof(tmp)
\end{lstlisting}

\begin{itemize}
\item Ejecutamos el código a analizar
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
zz <- sumNoise(1000)
\end{lstlisting}
\end{frame}

\begin{frame}[fragile,label={sec:orgf76c0f1}]{¿Cuánto tarda cada parte de mi función?: \texttt{Rprof}}
 \begin{itemize}
\item Paramos el análisis
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
Rprof()
\end{lstlisting}

\begin{itemize}
\item Extraemos el resumen
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
summaryRprof(tmp)
\end{lstlisting}

\begin{verbatim}
$by.self
         self.time self.pct total.time total.pct
"rnorm"       0.14    77.78       0.14     77.78
"unlist"      0.04    22.22       0.04     22.22

$by.total
                 total.time total.pct self.time self.pct
"sapply"               0.18    100.00      0.00     0.00
"sumNoise"             0.18    100.00      0.00     0.00
"rnorm"                0.14     77.78      0.14    77.78
"FUN"                  0.14     77.78      0.00     0.00
"lapply"               0.14     77.78      0.00     0.00
"unlist"               0.04     22.22      0.04    22.22
"simplify2array"       0.04     22.22      0.00     0.00

$sample.interval
[1] 0.02

$sampling.time
[1] 0.18
\end{verbatim}
\end{frame}


\section{Miscelánea}
\label{sec:orgd2bcd9b}
\begin{frame}[fragile,label={sec:orgb9ab77a}]{\texttt{do.call}}
 \begin{itemize}
\item Ejemplo: sumar los componentes de una lista
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
lista <- list(a = rnorm(100),
              b = runif(100),
              c = rexp(100))
with(lista, sum(a + b + c))
\end{lstlisting}

\begin{verbatim}
[1] 150.7289
\end{verbatim}

\begin{itemize}
\item En lugar de nombrar los componentes, creamos una llamada a una
función con \texttt{do.call}
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
do.call(sum, lista)
\end{lstlisting}

\begin{verbatim}
[1] 150.7289
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:orgf68dc68}]{\texttt{do.call}}
 \begin{itemize}
\item Se emplea frecuentemente con el resultado de \texttt{lapply}
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
  x <- rnorm(5)
  ll <- lapply(1:5, function(i)x^i)
  do.call(rbind, ll)
\end{lstlisting}

\begin{verbatim}
          [,1]       [,2]      [,3]       [,4]        [,5]
[1,] 0.7533039 -0.9398690 0.6944476 0.40232224 -0.41850226
[2,] 0.5674668  0.8833537 0.4822575 0.16186319  0.17514414
[3,] 0.4274750 -0.8302367 0.3349026 0.06512116 -0.07329822
[4,] 0.3220186  0.7803137 0.2325723 0.02619969  0.03067547
[5,] 0.2425779 -0.7333926 0.1615093 0.01054072 -0.01283775
\end{verbatim}

\begin{itemize}
\item Este mismo ejemplo puede resolverse con \texttt{sapply}
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
  sapply(1:5, function(i)x^i)
\end{lstlisting}

\begin{verbatim}
           [,1]      [,2]        [,3]       [,4]        [,5]
[1,]  0.7533039 0.5674668  0.42747500 0.32201860  0.24257788
[2,] -0.9398690 0.8833537 -0.83023671 0.78031372 -0.73339265
[3,]  0.6944476 0.4822575  0.33490259 0.23257231  0.16150929
[4,]  0.4023222 0.1618632  0.06512116 0.02619969  0.01054072
[5,] -0.4185023 0.1751441 -0.07329822 0.03067547 -0.01283775
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:org1376570}]{\texttt{Reduce}}
 \begin{itemize}
\item Combina sucesivamente los elementos de un objeto aplicando una
función binaria
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
## (((1+2)+3)+4)+5
Reduce('+', 1:5)
\end{lstlisting}

\begin{verbatim}
[1] 15
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:orgfcb4193}]{\texttt{Reduce}}
 \lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
## (((1/2)/3)/4)/5
Reduce('/', 1:5)
\end{lstlisting}

\begin{verbatim}
[1] 0.008333333
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
foo <- function(u, v)u + 1 /v
Reduce(foo, c(3, 7, 15, 1, 292))
## equivalente a
## foo(foo(foo(foo(3, 7), 15), 1), 292)
\end{lstlisting}

\begin{verbatim}
[1] 4.212948
\end{verbatim}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
Reduce(foo, c(3, 7, 15, 1, 292), right=TRUE)
## equivalente a
## foo(3, foo(7, foo(15, foo(1, 292))))
\end{lstlisting}

\begin{verbatim}
[1] 3.141593
\end{verbatim}
\end{frame}

\begin{frame}[fragile,label={sec:org75f3ff9}]{Funciones recursivas}
 \begin{itemize}
\item \href{http://en.wikibooks.org/wiki/R\_Programming/Working\_with\_functions\#Functions\_as\_Objects}{Serie de Fibonnaci}
\end{itemize}
\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
fib <- function(n){
    if (n>2) {
        c(fib(n-1),
          sum(tail(fib(n-1),2)))
    } else if (n>=0) rep(1,n)
}
\end{lstlisting}

\lstset{language=r,label= ,caption= ,captionpos=b,numbers=none}
\begin{lstlisting}
fib(10)
\end{lstlisting}

\begin{verbatim}
[1]  1  1  2  3  5  8 13 21 34 55
\end{verbatim}
\end{frame}
\end{document}